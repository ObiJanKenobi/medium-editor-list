!function(t,e){"use strict";"object"==typeof module?module.exports=e:"function"==typeof define&&define.amd?define(e):t.MediumEditorList=e}(this,function(){function t(t){return"undefined"!=typeof t&&null!==t}function e(t,e,n){if(void 0!==t.getSelection&&e){var i=t.createRange(),o=t.getSelection();n?i.setStartBefore(e):i.setStartAfter(e),i.collapse(!0),o.removeAllRanges(),o.addRange(i)}}"function"!=typeof Object.assign&&!function(){Object.assign=function(t){"use strict";if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(void 0!==i&&null!==i)for(var o in i)i.hasOwnProperty(o)&&(e[o]=i[o])}return e}}();var n="medium-editor-list-add-paragraph",i="data-medium-editor-list-id",o="medium-editor-list",r=function(r,s){function u(t){return M=t,h(),r.on(T,"click",c),r.on(j,"click",d),w=Number(t.getAttribute(i)),C}function l(t){var e,n=(new Date).getTime();return t=t?"<li>"+t+"<li>":s.newParagraphTemplate,A.pasteHTML('<ul class="'+o+'" '+i+'="'+n+'"> <li>'+t+"</li>"+S()+"</ul><br/>",{cleanAttrs:[]}),e=j.querySelector("ul["+i+'="'+n+'"].'+o),u(e)}function a(){return w}function c(){T.insertAdjacentHTML("beforebegin",s.newParagraphTemplate),L(),e(x,y[y.length-2],!0),g()}function d(){f()?g():b()}function f(){var t=MediumEditor.selection.getSelectionRange(x),e=MediumEditor.selection.getSelectedParentElement(t),n=MediumEditor.util.getClosestTag(e,"li");return n?Number(n.parentElement.getAttribute(i))===w:!1}function g(){E()!==!1&&(m()?v(T,"block"):(p(),v(T,"block")))}function m(){return t(M.querySelector("."+n))}function p(){M.insertAdjacentHTML("beforeend",S()),L(),h()}function h(){T=M.querySelector("."+n)}function b(){T&&(T.style.display="none")}function E(){return s.isEditable===!0}function v(t,e){t.style.display=e}function L(){y=M.querySelectorAll("li")}function S(){return'<li class="'+n+'">'+s.addParagraphTemplate+"</li>"}var T,y,M,w,C=this,x=r.document,A=r.base,j=A.origElements;C.init=u,C.create=l,C.show=g,C.getId=a},s=MediumEditor.Extension.extend({name:"list-extension",init:function(){var t=this;t.options=Object.assign({},{newParagraphTemplate:"<li>...</li>",buttonTemplate:"<b>List</b>",addParagraphTemplate:"Add new paragraph",isEditable:!0},t.base.options.mediumEditorList||{}),t.button=t.document.createElement("button"),t.button.classList.add("medium-editor-action"),t.button.innerHTML=t.options.buttonTemplate,t.editor=this.base,t.listInstances={},t.on(t.button,"click",t.onClick.bind(t)),t.initExistsingLists()},initExistsingLists:function(){for(var t,e=this.getExistsingLists(),n=0,i=e.length;i>n;n+=1)t=new r(this,this.options).init(e[n]),this.addList(t)},getExistsingLists:function(){var e=this.editor.origElements.querySelector("ul."+o);return t(e)?e:[]},getButton:function(){return this.button},onClick:function(){var e=this.getCurrentList();t(e)?e.show():(e=new r(this,this.options).create(this.getSelectedContextHtml()),this.addList(e))},addList:function(t){this.listInstances[t.getId()]=t},getSelectedContextHtml:function(){var t=this.document.createElement("div"),e=MediumEditor.selection.getSelectionRange(this.document).cloneContents().cloneNode(!0);return t.appendChild(e),t.innerHTML},getCurrentList:function(){var t,e=MediumEditor.selection.getSelectionRange(this.document),n=MediumEditor.selection.getSelectedParentElement(e),o=MediumEditor.util.getClosestTag(n,"li");return o?(t=o.parentElement.getAttribute(i),this.listInstances[Number(t)]):void 0}});return s}());